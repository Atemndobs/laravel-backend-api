Shift to class based factories
