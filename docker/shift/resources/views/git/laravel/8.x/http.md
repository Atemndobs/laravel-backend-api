Shift HTTP kernel and middleware
